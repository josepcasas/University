names(haircuts) <- c("country", "date", "haircut")
# make date a date format. Disregard day
haircuts$date <- as.Date(haircuts$date)
# create a year variable
haircuts$year <- year(haircuts$date)
# merge the pwt with the haircuts data frames
dataset <- merge(pwt, haircuts, by=c("country", "year"), all = TRUE)
# create a dummy for when a country restructures
dataset$restructure <- ifelse(is.na(dataset$haircut), rep(0, length(dataset$haircut)), rep(1, length(dataset$haircut)))
# calculates the growth rate variable
growth <- c()
for (country in levels(dataset$country)){
episodes
growth <- c(growth, countryGrowth(dataset$GDP[which(dataset$country==country)]))
}
# add the variable to the dataset data.frame
dataset$growth <- growth
debt <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v2/debt.csv")
debt <- as.data.frame(t(as.matrix(debt)))
codes <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v2/codes.csv")
dataset$code <- mapvalues(dataset$country, from = codes$ISO3A, to = codes$IMF3N)
dataset[which(is.character(dataset$code)),]
t(debt)
debt
# imports the IMF dataset. The data has year in columns and countries in rows
debt <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v2/debt.csv")
# transpose the dataframe
debt <- t(debt)
# imf uses number codes for countries. This file contains the dictionary for the number codes
codes <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v2/codes.csv")
dataset$code <- mapvalues(dataset$country, from = codes$ISO3A, to = codes$IMF3N)
debt
names(debt) <- debt[1,]
debt
debt[1,]
debt <- as.data.frame(t(debt))
names(debt) <- debt[1,]
debt
debt <- as.data.frame(t(debt))
debt[1,]
debt
debt
debt <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v2/debt.csv")
debt
debt <- as.data.frame(t(debt))
debt
debt[|,]
debt[1,]
rm(list=ls())
datos_t105 <- read.delim("~/Downloads/Chrome/datos_t105.tsv", header=FALSE)
View(datos_t105)
rm(list=ls())
setwd("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/")
require(lubridate) # for the year function
require(plyr)
require(plm)
require(stargazer)
require(sandwich)
require(lmtest)
dataset <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/dataset.csv")
growth2 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure, data = dataset, index=c("code.v2", "year"),  model="within")
summary(growth2)
# Standard Growth Regression + Haircut (FE)
growth3 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth3 <- coeftest(growth3, vcov.=vcovHC(growth3))
summary(growth3)
dataset$haircut[which(dataset$haircut == 0)] <- NA
# Standard Growth Regression + Haircut (FE)
growth3 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth3 <- coeftest(growth3, vcov.=vcovHC(growth3))
summary(growth3)
rm(list=ls())
setwd("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/")
require(lubridate) # for the year function
require(plyr)
require(plm)
require(stargazer)
require(sandwich)
require(lmtest)
dataset <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/dataset.csv")
datset<- dataset[which(dataset$year>=1980),]
# Standard Growth Regression (FE)
growth1 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth1 <- coeftest(growth1, vcov.=vcovHC(growth1))
# Standard Growth Regression (FE)
growth2 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth2 <- coeftest(growth2, vcov.=vcovHC(growth2))
# Standard Growth Regression + Haircut (FE)
growth3 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth3 <- coeftest(growth3, vcov.=vcovHC(growth3))
# Standard Growth Regression + Haircut + debt (FE)
growth4 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth4 <- coeftest(growth4, vcov.=vcovHC(growth4))
# Standard Growth Regression + Haircut + debt + fx (FE)
growth5 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth5 <- coeftest(growth5, vcov.=vcovHC(growth5))
# pooled
growth6 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="pooling")
tgrowth6 <- coeftest(growth6, vcov.=vcovHC(growth6))
summary(growth3)
summary(growth3)
summary(growth2)
summary(growth1)
summary(growth6)
# Standard Growth Regression (FE)
dyn1 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn1 <- coeftest(dyn1, vcov.=vcovHC(dyn1))
# Standard Growth Regression + restructure (FE)
dyn2 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure , data = dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn2 <- coeftest(dyn2, vcov.=vcovHC(dyn2))
# Standard Growth Regression + restructure + Haircut (FE)
dyn3 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn3 <- coeftest(dyn3, vcov.=vcovHC(dyn3))
# Standard Growth Regression + restructure + Haircut + debt (FE)
dyn4 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn4 <- coeftest(dyn4, vcov.=vcovHC(dyn4))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn5 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn5 <- coeftest(dyn5, vcov.=vcovHC(dyn5))
summary(t.dyn5)
t.dyn5
t.dyn4
t.dyn5
help("lag.zoo")
help("lag")
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn6 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn6 <- coeftest(dyn6, vcov.=vcovHC(dyn6))
t.dyn6
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn6 <- plm(growth ~ lag(growth) + lag(growth, k=2) + lag(growth, k=3) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn6 <- coeftest(dyn6, vcov.=vcovHC(dyn6))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn7 <- plm(growth ~ lag(growth) + lag(growth, k=2) + lag(growth, k=3) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn7 <- coeftest(dyn7, vcov.=vcovHC(dyn7))
t.dyn7
#this is the best specification from the ones ran above (i.e. dyn6)
g.t0 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t0r <- coeftest(g.t0, vcov.=vcovHC(g.t0))
g.t1 <- plm(growth ~ lag(growth, k = 2) + lag(growth, k=3) + lag(pop) + lag(hc) + lag(log(gdo)) + lag(log(capital)) + lag(productivity) + lag(cpi) + lag(restructure) + lag(haircut) + lag(debt) + lag(fx), index=c("code.v2", "year"),  model="within", methods="arellano")
g.t1r <- coeftest(g.t1, vcov.=vcovHC(g.t1))
g.t2 <- plm(growth ~ lag(growth, k = 3) + lag(growth, k=4) + lag(pop, k = 2) + lag(hc, k = 2) + lag(log(gdo), k = 2) + lag(log(capital), k = 2) + lag(productivity, k = 2) + lag(cpi, k = 2) + lag(restructure, k = 2) + lag(haircut, k = 2) + lag(debt, k = 2) + lag(fx, k = 2), index=c("code.v2", "year"),  model="within", methods="arellano")
g.t2r <- coeftest(g.t2, vcov.=vcovHC(g.t3))
#this is the best specification from the ones ran above (i.e. dyn6)
g.t0 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t0r <- coeftest(g.t0, vcov.=vcovHC(g.t0))
g.t1 <- plm(growth ~ lag(growth, k = 2) + lag(growth, k=3) + lag(pop) + lag(hc) + lag(log(gdo)) + lag(log(capital)) + lag(productivity) + lag(cpi) + lag(restructure) + lag(haircut) + lag(debt) + lag(fx), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t1r <- coeftest(g.t1, vcov.=vcovHC(g.t1))
g.t2 <- plm(growth ~ lag(growth, k = 3) + lag(growth, k=4) + lag(pop, k = 2) + lag(hc, k = 2) + lag(log(gdo), k = 2) + lag(log(capital), k = 2) + lag(productivity, k = 2) + lag(cpi, k = 2) + lag(restructure, k = 2) + lag(haircut, k = 2) + lag(debt, k = 2) + lag(fx, k = 2), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t2r <- coeftest(g.t2, vcov.=vcovHC(g.t2))
#this is the best specification from the ones ran above (i.e. dyn6)
g.t0 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t0r <- coeftest(g.t0, vcov.=vcovHC(g.t0))
g.t1 <- plm(growth ~ lag(growth, k = 2) + lag(growth, k=3) + lag(pop) + lag(hc) + lag(log(gdp)) + lag(log(capital)) + lag(productivity) + lag(cpi) + lag(restructure) + lag(haircut) + lag(debt) + lag(fx), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t1r <- coeftest(g.t1, vcov.=vcovHC(g.t1))
g.t2 <- plm(growth ~ lag(growth, k = 3) + lag(growth, k=4) + lag(pop, k = 2) + lag(hc, k = 2) + lag(log(gdp), k = 2) + lag(log(capital), k = 2) + lag(productivity, k = 2) + lag(cpi, k = 2) + lag(restructure, k = 2) + lag(haircut, k = 2) + lag(debt, k = 2) + lag(fx, k = 2), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t2r <- coeftest(g.t2, vcov.=vcovHC(g.t2))
g.t12
g.t1r
g.t2e
g.t2r
g.t3 <- plm(growth ~ lag(growth, k = 4) + lag(growth, k=5) + lag(pop, k = 3) + lag(hc, k = 3) + lag(log(gdp), k = 3) + lag(log(capital), k = 3) + lag(productivity, k = 3) + lag(cpi, k = 3) + lag(restructure, k = 3) + lag(haircut, k = 3) + lag(debt, k = 3) + lag(fx, k = 3), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t3r <- coeftest(g.t3, vcov.=vcovHC(g.t3))
g.t3r
#------------------------------------------------------------------------------------------------------------------------------------------
# Counterfactuals
#this is the best specification from the ones ran above (i.e. dyn6)
g.t0 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t0r <- coeftest(g.t0, vcov.=vcovHC(g.t0))
g.t1 <- plm(growth ~ lag(growth, k = 2) + lag(growth, k=3) + lag(pop) + lag(hc) + lag(log(gdp)) + lag(log(capital)) + lag(productivity) + lag(cpi) + lag(restructure) + lag(haircut) + lag(debt) + lag(fx), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t1r <- coeftest(g.t1, vcov.=vcovHC(g.t1))
g.t2 <- plm(growth ~ lag(growth, k = 3) + lag(growth, k=4) + lag(pop, k = 2) + lag(hc, k = 2) + lag(log(gdp), k = 2) + lag(log(capital), k = 2) + lag(productivity, k = 2) + lag(cpi, k = 2) + lag(restructure, k = 2) + lag(haircut, k = 2) + lag(debt, k = 2) + lag(fx, k = 2), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t2r <- coeftest(g.t2, vcov.=vcovHC(g.t2))
g.t3 <- plm(growth ~ lag(growth, k = 4) + lag(growth, k=5) + lag(pop, k = 3) + lag(hc, k = 3) + lag(log(gdp), k = 3) + lag(log(capital), k = 3) + lag(productivity, k = 3) + lag(cpi, k = 3) + lag(restructure, k = 3) + lag(haircut, k = 3) + lag(debt, k = 3) + lag(fx, k = 3), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t3r <- coeftest(g.t3, vcov.=vcovHC(g.t3))
g.t4 <- plm(growth ~ lag(growth, k = 5) + lag(growth, k=6) + lag(pop, k = 4) + lag(hc, k = 4) + lag(log(gdp), k = 4) + lag(log(capital), k = 4) + lag(productivity, k = 4) + lag(cpi, k = 4) + lag(restructure, k = 4) + lag(haircut, k = 4) + lag(debt, k = 4) + lag(fx, k = 4), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t4r <- coeftest(g.t4, vcov.=vcovHC(g.t4))
dataset<- dataset[which(dataset$year>=1980),]
rm(list=ls())
setwd("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/")
require(lubridate) # for the year function
require(plyr)
require(plm)
require(stargazer)
require(sandwich)
require(lmtest)
dataset <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/dataset.csv")
# Standard Growth Regression (FE)
growth1 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth1 <- coeftest(growth1, vcov.=vcovHC(growth1))
# Standard Growth Regression (FE)
growth2 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth2 <- coeftest(growth2, vcov.=vcovHC(growth2))
# Standard Growth Regression + Haircut (FE)
growth3 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth3 <- coeftest(growth3, vcov.=vcovHC(growth3))
# Standard Growth Regression + Haircut + debt (FE)
growth4 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth4 <- coeftest(growth4, vcov.=vcovHC(growth4))
# Standard Growth Regression + Haircut + debt + fx (FE)
growth5 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth5 <- coeftest(growth5, vcov.=vcovHC(growth5))
# pooled
growth6 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="pooling")
tgrowth6 <- coeftest(growth6, vcov.=vcovHC(growth6))
tgrowth5
dataset<- dataset[which(dataset$year>=1980),]
# Standard Growth Regression (FE)
growth1 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth1 <- coeftest(growth1, vcov.=vcovHC(growth1))
# Standard Growth Regression (FE)
growth2 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth2 <- coeftest(growth2, vcov.=vcovHC(growth2))
# Standard Growth Regression + Haircut (FE)
growth3 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth3 <- coeftest(growth3, vcov.=vcovHC(growth3))
# Standard Growth Regression + Haircut + debt (FE)
growth4 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth4 <- coeftest(growth4, vcov.=vcovHC(growth4))
# Standard Growth Regression + Haircut + debt + fx (FE)
growth5 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth5 <- coeftest(growth5, vcov.=vcovHC(growth5))
# pooled
growth6 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="pooling")
tgrowth6 <- coeftest(growth6, vcov.=vcovHC(growth6))
tgrowth5
rm(list=ls())
setwd("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/")
require(lubridate) # for the year function
require(plyr)
require(plm)
require(stargazer)
require(sandwich)
require(lmtest)
dataset <- read.csv("/Users/josepcasas/Documents/bgse/bgse-code/Indepent Study Project/data-v3/dataset.csv")
#------------------------------------------------------------------------------------------------------------------------------------------
# Regressions
#------------------------------------------------------------------------------------------------------------------------------------------
# Standard Growth Regression (FE)
growth1 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth1 <- coeftest(growth1, vcov.=vcovHC(growth1))
# Standard Growth Regression (FE)
growth2 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure, data = dataset, index=c("code.v2", "year"),  model="within")
tgrowth2 <- coeftest(growth2, vcov.=vcovHC(growth2))
# Standard Growth Regression + Haircut (FE)
growth3 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth3 <- coeftest(growth3, vcov.=vcovHC(growth3))
# Standard Growth Regression + Haircut + debt (FE)
growth4 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth4 <- coeftest(growth4, vcov.=vcovHC(growth4))
# Standard Growth Regression + Haircut + debt + fx (FE)
growth5 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within")
tgrowth5 <- coeftest(growth5, vcov.=vcovHC(growth5))
# pooled
growth6 <- plm(growth ~ pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="pooling")
tgrowth6 <- coeftest(growth6, vcov.=vcovHC(growth6))
tgrowth5
#------------------------------------------------------------------------------------------------------------------------------------------
# Dynamic Models (with 1 lag)
# Standard Growth Regression (FE)
dyn1 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn1 <- coeftest(dyn1, vcov.=vcovHC(dyn1))
# Standard Growth Regression + restructure (FE)
dyn2 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure , data = dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn2 <- coeftest(dyn2, vcov.=vcovHC(dyn2))
# Standard Growth Regression + restructure + Haircut (FE)
dyn3 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn3 <- coeftest(dyn3, vcov.=vcovHC(dyn3))
# Standard Growth Regression + restructure + Haircut + debt (FE)
dyn4 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn4 <- coeftest(dyn4, vcov.=vcovHC(dyn4))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn5 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn5 <- coeftest(dyn5, vcov.=vcovHC(dyn5))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn6 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn6 <- coeftest(dyn6, vcov.=vcovHC(dyn6))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn7 <- plm(growth ~ lag(growth) + lag(growth, k=2) + lag(growth, k=3) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn7 <- coeftest(dyn7, vcov.=vcovHC(dyn7))
t.dyn6
t.dyn7
t.dyn5
t.dyn6
#------------------------------------------------------------------------------------------------------------------------------------------
# Counterfactual Regressions
#this is the best specification from the ones ran above (i.e. dyn6)
g.t0 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t0r <- coeftest(g.t0, vcov.=vcovHC(g.t0))
g.t1 <- plm(growth ~ lag(growth, k = 2) + lag(growth, k=3) + lag(pop) + lag(hc) + lag(log(gdp)) + lag(log(capital)) + lag(productivity) + lag(cpi) + lag(restructure) + lag(haircut) + lag(debt) + lag(fx), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t1r <- coeftest(g.t1, vcov.=vcovHC(g.t1))
g.t2 <- plm(growth ~ lag(growth, k = 3) + lag(growth, k=4) + lag(pop, k = 2) + lag(hc, k = 2) + lag(log(gdp), k = 2) + lag(log(capital), k = 2) + lag(productivity, k = 2) + lag(cpi, k = 2) + lag(restructure, k = 2) + lag(haircut, k = 2) + lag(debt, k = 2) + lag(fx, k = 2), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t2r <- coeftest(g.t2, vcov.=vcovHC(g.t2))
g.t3 <- plm(growth ~ lag(growth, k = 4) + lag(growth, k=5) + lag(pop, k = 3) + lag(hc, k = 3) + lag(log(gdp), k = 3) + lag(log(capital), k = 3) + lag(productivity, k = 3) + lag(cpi, k = 3) + lag(restructure, k = 3) + lag(haircut, k = 3) + lag(debt, k = 3) + lag(fx, k = 3), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t3r <- coeftest(g.t3, vcov.=vcovHC(g.t3))
g.t4 <- plm(growth ~ lag(growth, k = 5) + lag(growth, k=6) + lag(pop, k = 4) + lag(hc, k = 4) + lag(log(gdp), k = 4) + lag(log(capital), k = 4) + lag(productivity, k = 4) + lag(cpi, k = 4) + lag(restructure, k = 4) + lag(haircut, k = 4) + lag(debt, k = 4) + lag(fx, k = 4), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t4r <- coeftest(g.t4, vcov.=vcovHC(g.t4))
gt1r
g.t1r
g.t2r
g.t3r
g.t4r
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn6 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn6 <- coeftest(dyn6, vcov.=vcovHC(dyn6))
t.dyn6
#this is the best specification from the ones ran above (i.e. dyn6)
g.t0 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t0r <- coeftest(g.t0, vcov.=vcovHC(g.t0))
g.t1 <- plm(growth ~ lag(growth, k = 2) + lag(growth, k=3) + lag(pop) + lag(hc) + lag(log(gdp)) + lag(log(capital)) + lag(productivity) + lag(cpi) + lag(restructure) + lag(haircut) + lag(debt) + lag(fx), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t1r <- coeftest(g.t1, vcov.=vcovHC(g.t1))
g.t2 <- plm(growth ~ lag(growth, k = 3) + lag(growth, k=4) + lag(pop, k = 2) + lag(hc, k = 2) + lag(log(gdp), k = 2) + lag(log(capital), k = 2) + lag(productivity, k = 2) + lag(cpi, k = 2) + lag(restructure, k = 2) + lag(haircut, k = 2) + lag(debt, k = 2) + lag(fx, k = 2), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t2r <- coeftest(g.t2, vcov.=vcovHC(g.t2))
g.t3 <- plm(growth ~ lag(growth, k = 4) + lag(growth, k=5) + lag(pop, k = 3) + lag(hc, k = 3) + lag(log(gdp), k = 3) + lag(log(capital), k = 3) + lag(productivity, k = 3) + lag(cpi, k = 3) + lag(restructure, k = 3) + lag(haircut, k = 3) + lag(debt, k = 3) + lag(fx, k = 3), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t3r <- coeftest(g.t3, vcov.=vcovHC(g.t3))
g.t4 <- plm(growth ~ lag(growth, k = 5) + lag(growth, k=6) + lag(pop, k = 4) + lag(hc, k = 4) + lag(log(gdp), k = 4) + lag(log(capital), k = 4) + lag(productivity, k = 4) + lag(cpi, k = 4) + lag(restructure, k = 4) + lag(haircut, k = 4) + lag(debt, k = 4) + lag(fx, k = 4), data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
g.t4r <- coeftest(g.t4, vcov.=vcovHC(g.t4))
g.t0r
g.t1r
g.t2r
dataset$haircut2 <- dataset$haircut^2
dataset$haircut3 <- dataset$haircut^3
dataset$haircut2 <- dataset$haircut^2
dataset$haircut3 <- dataset$haircut^3
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8
dataset$haircut2 <- dataset$haircut^2
dataset$haircut3 <- dataset$haircut^3
dataset$haircut4 <- dataset$haircut^4
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + haircut4 + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + debt + fx + restructure * fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8
stargazer(t.dyn8, title="Results", align=TRUE)
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
t.dyn8
stargazer(t.dyn8, title="Results", align=TRUE)
#------------------------------------------------------------------------------------------------------------------------------------------
# Dynamic Models (with 1 lag)
# Standard Growth Regression (FE)
dyn1 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi, data = dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn1 <- coeftest(dyn1, vcov.=vcovHC(dyn1))
# Standard Growth Regression + restructure (FE)
dyn2 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure , data = dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn2 <- coeftest(dyn2, vcov.=vcovHC(dyn2))
# Standard Growth Regression + restructure + Haircut (FE)
dyn3 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn3 <- coeftest(dyn3, vcov.=vcovHC(dyn3))
# Standard Growth Regression + restructure + Haircut + debt (FE)
dyn4 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn4 <- coeftest(dyn4, vcov.=vcovHC(dyn4))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn5 <- plm(growth ~ lag(growth) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn5 <- coeftest(dyn5, vcov.=vcovHC(dyn5))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn6 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn6 <- coeftest(dyn6, vcov.=vcovHC(dyn6))
# Standard Growth Regression + restructure + Haircut + debt + fx (FE)
dyn7 <- plm(growth ~ lag(growth) + lag(growth, k=2) + lag(growth, k=3) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn7 <- coeftest(dyn7, vcov.=vcovHC(dyn7))
dataset$haircut2 <- dataset$haircut^2
dataset$haircut3 <- dataset$haircut^3
dataset$haircut4 <- dataset$haircut^4
# Standard Growth Regression + restructure + haircut + haircut2 + haircut3 + debt + fx (FE + Arellano)
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
# Standard Growth Regression + restructure + haircut + haircut2 + haircut3 + debt + fx (FE + Arellano)
#dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure  + haircut + haircut2 + haircut3 + debt + fx, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
#t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
# Standard
stargazer(t.dyn1, t.dyn2, t.dyn3, t.dyn4, t.dyn5, t.dyn6, t.dyn7, t.dyn8, title="Results", align=TRUE)
# Standard Growth Regression + restructure + haircut + haircut2 + haircut3 + debt + fx (FE + Arellano)
dyn8 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
t.dyn8 <- coeftest(dyn8, vcov.=vcovHC(dyn8))
res1 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
res2 <- plm(haircut ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
plot(res1$residuals, res2$residuals)
# Standard Growth Regression + restructure + haircut + haircut2 + haircut3 + debt + fx (FE + Arellano)
res1 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset[which(dataset$restructure==1),], index=c("code.v2", "year"),  model="within", methods="arellano")
t.res1 <- coeftest(res1, vcov.=vcovHC(res1))
res2 <- plm(haircut ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset[which(dataset$restructure==1),], index=c("code.v2", "year"),  model="within", methods="arellano")
t.res1 <- coeftest(res1, vcov.=vcovHC(res1))
plot(res1$residuals, res2$residuals)
# haircut + haircut2 + haircut3
# Standard Growth Regression + restructure + haircut + haircut2 + haircut3 + debt + fx (FE + Arellano)
res1 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset[which(dataset$restructure==1),], index=c("code.v2", "year"),  model="within", methods="arellano")
res2 <- plm(haircut ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset[which(dataset$restructure==1),], index=c("code.v2", "year"),  model="within", methods="arellano")
plot(res1$residuals, res2$residuals)
plot(res1$residuals[which(dataset$restructure==1),], res2$residuals[which(dataset$restructure==1),])
plot(res1$residuals, res2$residuals)
plot(dataset$growth, dataset$restructure)
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
# Standard Growth Regression + restructure + haircut + haircut2 + haircut3 + debt + fx (FE + Arellano)
res1 <- plm(growth ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
res2 <- plm(haircut ~ lag(growth) + lag(growth, k=2) + pop + hc + log(gdp) + log(capital) + productivity + cpi + restructure + debt + fx + restructure * fx + restructure * debt, data=dataset, index=c("code.v2", "year"),  model="within", methods="arellano")
plot(res1$residuals, res2$residuals)
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
p <- lm(growth ~ haircut + haircut2, data = dataset)
abline(p)
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
p <- lm(growth ~ haircut + haircut^2, data = dataset)
fitted(p)
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
plot(haircut, fitted(lm(growth ~ haircut + I(haircut^2), data = dataset)), type="l")
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
plot(dataset$haircut, fitted(lm(growth ~ haircut + I(haircut^2), data = dataset)), type="l")
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
lines(predict(lm(growth ~ haircut + I(haircut^2), data = dataset)))
plot(dataset$haircut[which(dataset$restructure==1)], dataset$growth[which(dataset$restructure==1)])
lines(predict(lm(growth ~ haircut + haircut^2, data = dataset)))
plot(dataset$haircut, fitted(lm(growth ~ haircut + I(haircut^2), data = dataset)), type="l")
plot(dataset$haircut, fitted(lm(growth ~ haircut + haircut^2, data = dataset)), type="l")
plot(dataset$haircut, fitted(lm(growth ~ haircut + haircut2, data = dataset)), type="l")
plot(dataset$haircut, fitted(lm(growth ~ haircut + haircut2, data = dataset)))
library(ggplot2)
ggplot(dataset, aes(haircut, growth)) + geom_point() + geom_smooth()
ggplot(dataset[which(dataset$restructure==1)], aes(haircut, growth)) + geom_point() + geom_smooth()
ggplot(dataset[which(dataset$restructure==1),], aes(haircut, growth)) + geom_point() + geom_smooth()
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<0.75),], aes(haircut, growth)) + geom_point() + geom_smooth()
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<0.6),], aes(haircut, growth)) + geom_point() + geom_smooth()
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + geom_smooth()
help(I)
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + stat_smooth(method = "lm", formula = growth ~ haircut + I(haircut^2), size = 1)
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + stat_smooth(method = "lm", formula = dataset$growth ~ dataset$haircut + I(dataset$haircut^2), size = 1)
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + stat_smooth(method = "lm", formula = growth ~ haircut + I(haircut^2), data = dataset, size = 1)
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + stat_smooth(method = "lm", formula = growth ~ poly(haircut, 2), data = dataset, size = 1)
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + stat_smooth(method = "lm", formula = dataset$growth ~ poly(dataset$haircut, 2), size = 1)
ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point() + stat_smooth(method = "lm", formula = dataset$growth[which(dataset$restructure==1 & dataset$haircut<1.2)] ~ dataset$haircut[which(dataset$restructure==1 & dataset$haircut<1.2)] + I(dataset$haircut[which(dataset$restructure==1 & dataset$haircut<1.2)]), size = 1)
g <- g + stat_smooth(method = "lm", formula = growth ~ haircut + I(haircut^2), size = 1)
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = growth ~ haircut + I(haircut^2), size = 1)
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = growth ~ haircut + I(haircut^2), size = 1)
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = growth ~ haircut + I(haircut^2), data=dataset, size = 1)
g
g <- g + stat_smooth(method = "lm", formula = dataset$growth ~ dataset$haircut + I(dataset$haircut^2), size = 1)
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = dataset$growth ~ dataset$haircut + I(dataset$haircut^2), size = 1)
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$haircut<1.2),], aes(haircut, growth)) + geom_point()
g <- g +stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g
median(log(dataset$gdp))
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(haircut, growth)) + geom_point()
g <- g +stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g
g<- ggplot(dataset[which(dataset$restructure==1  & dataset$fx < 4) ,], aes(haircut, growth)) + geom_point()
g <- g +stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g
g<- ggplot(dataset[which(dataset$restructure==1 ),], aes(haircut, growth)) + geom_point()
g <- g +stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g
g<- ggplot(dataset[which(dataset$restructure==1 ),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1)
g
g<- ggplot(dataset[which(dataset$restructure==1 ),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp < median(dataset$gdp)),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(haircut, growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(lag(haircut), growth)) + geom_point()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(lag(haircut), growth), label=rownames(country)) + geom_point()  + geom_text()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(lag(haircut), growth), label=country) + geom_point()  + geom_text()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > median(dataset$gdp)),], aes(lag(haircut), growth, label=country) ) + geom_point()  + geom_text()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > mean(dataset$gdp)),], aes(lag(haircut), growth, label=country) ) + geom_point()  + geom_text()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red")
g
lenght(dataset[which(dataset$restructure==1 & dataset$gdp > mean(dataset$gdp)),])
length(dataset[which(dataset$restructure==1 & dataset$gdp > mean(dataset$gdp)),])
g<- ggplot(dataset[which(dataset$restructure==1 & dataset$gdp > mean(dataset$gdp)),], aes(lag(haircut), growth, label=country) ) + geom_point()  + geom_text()
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 2), size = 1)
g <- g + stat_smooth(method = "lm", formula = y ~ poly(x, 3), size = 1, color = "red") + theme_fivethirtyeight()
g
